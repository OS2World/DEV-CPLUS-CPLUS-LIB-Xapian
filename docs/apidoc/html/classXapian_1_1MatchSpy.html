<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<title>Xapian: API Documentation: xapian-core: Xapian::MatchSpy Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head>
<body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.5.2 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li class="current"><a href="classes.html"><span>Classes</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul>
</div>
<div class="tabs">
  <ul>
    <li><a href="classes.html"><span>Alphabetical&nbsp;List</span></a></li>
    <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
    <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
    <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
  </ul>
</div>
<div class="nav">
<a class="el" href="namespaceXapian.html">Xapian</a>::<a class="el" href="classXapian_1_1MatchSpy.html">MatchSpy</a></div>
<h1>Xapian::MatchSpy Class Reference</h1><!-- doxytag: class="Xapian::MatchSpy" --><!-- doxytag: inherits="Xapian::MatchDecider" -->Class for classifying matching documents by their values.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;<a class="el" href="matchspy_8h-source.html">matchspy.h</a>&gt;</code>
<p>
Inheritance diagram for Xapian::MatchSpy:<p><center><img src="classXapian_1_1MatchSpy__inherit__graph.png" border="0" usemap="#Xapian_1_1MatchSpy__inherit__map" alt="Inheritance graph"></center>
<map name="Xapian_1_1MatchSpy__inherit__map">
<area shape="rect" href="classXapian_1_1MatchDecider.html" title="Base class for matcher decision functor." alt="" coords="5,5,176,32"></map>
<center><font size="2">[<a href="graph_legend.html">legend</a>]</font></center>Collaboration diagram for Xapian::MatchSpy:<p><center><img src="classXapian_1_1MatchSpy__coll__graph.png" border="0" usemap="#Xapian_1_1MatchSpy__coll__map" alt="Collaboration graph"></center>
<map name="Xapian_1_1MatchSpy__coll__map">
<area shape="rect" href="classXapian_1_1MatchDecider.html" title="Base class for matcher decision functor." alt="" coords="5,5,176,32"></map>
<center><font size="2">[<a href="graph_legend.html">legend</a>]</font></center><a href="classXapian_1_1MatchSpy-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXapian_1_1MatchSpy.html#157db0146aded53e891b207a7721983a">MatchSpy</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Default constructor.  <a href="#157db0146aded53e891b207a7721983a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXapian_1_1MatchSpy.html#b68efafbed8586adc56a7877893aa28a">MatchSpy</a> (<a class="el" href="namespaceXapian.html#e163c06958fa73cfac44a38c3eea5c10">Xapian::valueno</a> valno)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Construct a <a class="el" href="classXapian_1_1MatchSpy.html" title="Class for classifying matching documents by their values.">MatchSpy</a> which classifies documents by a particular value.  <a href="#b68efafbed8586adc56a7877893aa28a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXapian_1_1MatchSpy.html#6143af126bb54297db40b1628d4e66f9">add_category</a> (<a class="el" href="namespaceXapian.html#e163c06958fa73cfac44a38c3eea5c10">Xapian::valueno</a> valno)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add a value number to classify documents by.  <a href="#6143af126bb54297db40b1628d4e66f9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXapian_1_1MatchSpy.html#0e3b344d0d8c0644a10c6688703891b9">operator()</a> (const <a class="el" href="classXapian_1_1Document.html">Xapian::Document</a> &amp;doc) const</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Implementation of virtual operator().  <a href="#0e3b344d0d8c0644a10c6688703891b9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">size_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXapian_1_1MatchSpy.html#0cb868372ad8702f2625b4e0e5072c60">get_total</a> () const</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the total number of documents tallied.  <a href="#0cb868372ad8702f2625b4e0e5072c60"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const std::map&lt; std::string,<br>
 size_t &gt; &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXapian_1_1MatchSpy.html#25f97a78ade3dc83b0bd42e3f6f620c7">get_categories</a> (<a class="el" href="namespaceXapian.html#e163c06958fa73cfac44a38c3eea5c10">Xapian::valueno</a> valno) const</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the categorisation for value number <em>valno</em>.  <a href="#25f97a78ade3dc83b0bd42e3f6f620c7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXapian_1_1MatchSpy.html#a0d81fc1d0db6318227015282936f0fe">score_categorisation</a> (<a class="el" href="namespaceXapian.html#e163c06958fa73cfac44a38c3eea5c10">Xapian::valueno</a> valno, double desired_no_of_categories=0.0)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return a score reflecting how "good" a categorisation is.  <a href="#a0d81fc1d0db6318227015282936f0fe"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classXapian_1_1MatchSpy.html#ce5d48475e4794ebadc6ac9d6cf98663">build_numeric_ranges</a> (<a class="el" href="namespaceXapian.html#e163c06958fa73cfac44a38c3eea5c10">Xapian::valueno</a> valno, size_t max_ranges)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Turn a category containing sort-encoded numeric values into a set of ranges.  <a href="#ce5d48475e4794ebadc6ac9d6cf98663"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Class for classifying matching documents by their values. 
<p>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="157db0146aded53e891b207a7721983a"></a><!-- doxytag: member="Xapian::MatchSpy::MatchSpy" ref="157db0146aded53e891b207a7721983a" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Xapian::MatchSpy::MatchSpy           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Default constructor. 
<p>

</div>
</div><p>
<a class="anchor" name="b68efafbed8586adc56a7877893aa28a"></a><!-- doxytag: member="Xapian::MatchSpy::MatchSpy" ref="b68efafbed8586adc56a7877893aa28a" args="(Xapian::valueno valno)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Xapian::MatchSpy::MatchSpy           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceXapian.html#e163c06958fa73cfac44a38c3eea5c10">Xapian::valueno</a>&nbsp;</td>
          <td class="paramname"> <em>valno</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Construct a <a class="el" href="classXapian_1_1MatchSpy.html" title="Class for classifying matching documents by their values.">MatchSpy</a> which classifies documents by a particular value. 
<p>
Further values can be added by calling <em><a class="el" href="classXapian_1_1MatchSpy.html#6143af126bb54297db40b1628d4e66f9" title="Add a value number to classify documents by.">add_category()</a></em>. 
</div>
</div><p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="6143af126bb54297db40b1628d4e66f9"></a><!-- doxytag: member="Xapian::MatchSpy::add_category" ref="6143af126bb54297db40b1628d4e66f9" args="(Xapian::valueno valno)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Xapian::MatchSpy::add_category           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceXapian.html#e163c06958fa73cfac44a38c3eea5c10">Xapian::valueno</a>&nbsp;</td>
          <td class="paramname"> <em>valno</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Add a value number to classify documents by. 
<p>
A <a class="el" href="classXapian_1_1MatchSpy.html" title="Class for classifying matching documents by their values.">MatchSpy</a> can classify by one or more values. 
</div>
</div><p>
<a class="anchor" name="0e3b344d0d8c0644a10c6688703891b9"></a><!-- doxytag: member="Xapian::MatchSpy::operator()" ref="0e3b344d0d8c0644a10c6688703891b9" args="(const Xapian::Document &amp;doc) const" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Xapian::MatchSpy::operator()           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classXapian_1_1Document.html">Xapian::Document</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>doc</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Implementation of virtual operator(). 
<p>
This implementation tallies values for a matching document. 
<p>
Implements <a class="el" href="classXapian_1_1MatchDecider.html#db23c53457e5cebeeb0a330ada32de95">Xapian::MatchDecider</a>.
</div>
</div><p>
<a class="anchor" name="0cb868372ad8702f2625b4e0e5072c60"></a><!-- doxytag: member="Xapian::MatchSpy::get_total" ref="0cb868372ad8702f2625b4e0e5072c60" args="() const" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t Xapian::MatchSpy::get_total           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return the total number of documents tallied. 
<p>

</div>
</div><p>
<a class="anchor" name="25f97a78ade3dc83b0bd42e3f6f620c7"></a><!-- doxytag: member="Xapian::MatchSpy::get_categories" ref="25f97a78ade3dc83b0bd42e3f6f620c7" args="(Xapian::valueno valno) const" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const std::map&lt;std::string, size_t&gt;&amp; Xapian::MatchSpy::get_categories           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceXapian.html#e163c06958fa73cfac44a38c3eea5c10">Xapian::valueno</a>&nbsp;</td>
          <td class="paramname"> <em>valno</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return the categorisation for value number <em>valno</em>. 
<p>

</div>
</div><p>
<a class="anchor" name="a0d81fc1d0db6318227015282936f0fe"></a><!-- doxytag: member="Xapian::MatchSpy::score_categorisation" ref="a0d81fc1d0db6318227015282936f0fe" args="(Xapian::valueno valno, double desired_no_of_categories=0.0)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Xapian::MatchSpy::score_categorisation           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceXapian.html#e163c06958fa73cfac44a38c3eea5c10">Xapian::valueno</a>&nbsp;</td>
          <td class="paramname"> <em>valno</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>desired_no_of_categories</em> = <code>0.0</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return a score reflecting how "good" a categorisation is. 
<p>
If you don't want to show a poor categorisation, or have multiple categories and only space in your user interface to show a few, you want to be able to decide how "good" a categorisation is. We define a good categorisation as one which offers a fairly even split, and (optionally) about a specified number of options.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>valno</em>&nbsp;</td><td>Value number to look at the categorisation for.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>desired_no_of_categories</em>&nbsp;</td><td>The desired number of categories - this is a floating point value, so you can ask for 5.5 if you'd like "about 5 or 6 categories". The default is to desire the number of categories that there actually are, so the score then only reflects how even the split is.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>A score for the categorisation for value <em>valno</em> - lower is better, with a perfectly even split across the right number of categories scoring 0. </dd></dl>

</div>
</div><p>
<a class="anchor" name="ce5d48475e4794ebadc6ac9d6cf98663"></a><!-- doxytag: member="Xapian::MatchSpy::build_numeric_ranges" ref="ce5d48475e4794ebadc6ac9d6cf98663" args="(Xapian::valueno valno, size_t max_ranges)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Xapian::MatchSpy::build_numeric_ranges           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceXapian.html#e163c06958fa73cfac44a38c3eea5c10">Xapian::valueno</a>&nbsp;</td>
          <td class="paramname"> <em>valno</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>max_ranges</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Turn a category containing sort-encoded numeric values into a set of ranges. 
<p>
For "continuous" values (such as price, height, weight, etc), there will usually be too many different values to offer the user, and the user won't want to restrict to an exact value anyway.<p>
This method produces a set of ranges for a particular value number. The ranges replace the category data for value <em>valno</em> - the keys are either empty (entry for "no value set"), &lt;= 9 bytes long (a singleton encoded value), or &gt; 9 bytes long (the first 9 bytes are the encoded range start, the rest the encoded range end).<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>valno</em>&nbsp;</td><td>Value number to produce ranges for. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>max_ranges</em>&nbsp;</td><td>Group into at most this many ranges.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>true if ranges could be built; false if not (e.g. all values the same, no values set, or other reasons). </dd></dl>

</div>
</div><p>
<hr>The documentation for this class was generated from the following file:<ul>
<li>include/xapian/<a class="el" href="matchspy_8h-source.html">matchspy.h</a></ul>
<hr>
<address><small>
Documentation for Xapian (version 1.0.2).<br>
Generated on 5 Jul 2007 by
<a href="http://www.doxygen.org/">Doxygen 1.5.2</a>.
</small></address>
</body>
</html>
